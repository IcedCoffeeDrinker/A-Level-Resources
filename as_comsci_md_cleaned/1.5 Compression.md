# 1.5 Compression

## Lossy vs Lossless compression
- **Lossy compression:**
    - store larger areas of pixels as a single color
    - reduce color depth
- **Lossless compression:**
    - store the color and pixel of that color in a row (eg)
    - ideal for images with large patches of exactly the same color (eg logos, cartoons, etc.)
    - ↳ excellent for vector graphics

---

## purpose of compression
- reduce file size
- reduce download times
- reduce storage requirements
- make best use of bandwith <- critical

> [!NOTE] a compressed file needs to be uncompressed in order to read it

### difference between lossy and lossless compression?
- **lossy** is data gets lost
- **lossless**: all data can be restored through decompression to the original

## When to use which?
- files such as text documents are not applicable for lossy compression
- lossy compression is good for image, audio, video, multimedia...

---

## Codec
A piece of software that encodes and decodes information (data)
```
[video] -> [Encoder] -> [compressed file on server/storage] -> [Decoder] -> [video]
```
- **encoder:** compresses video
- **decoder:** de-compresses (original) file

---

## Video compression methods:
- **Spatial (Inter-frame) coding**
    - compressing video frame by frame
    - ↳ good but not great, as many frames are nearly alike -> wasted compression opportunity (across frames)
- **block motion estimation, aka motion compensation**
    - tile an image and for the next frame determine motion vectors that shift the blocks to closely match the next frame
    - keep the tiles that are not changing (just changing position)

### Inter-frame vs Intra-frame
- **Inter-frame**: compression over multiple frames
- **Intra-frame**: compression of individual frames
```
[reference frame] <---> [residual frames] <---> [reference frame]
       ^                     ^                       ^
       |                     |                       |
  fully stored        difference stored         fully stored
```
`residual frames hold very little information, therefore are very compressible. (motion compression)`

---

# Book additions
- often lossy and lossless compression are combined for the best results

## Run-length encoding
- lossless compression method, works well with bitmaps
- **How it works?**
    - Sequences of the same byte are compressed by defining the byte and then the number of times it is repeated (the count)
    - e.g. `01100110 01100110 01100110 01100110`
    - is replaced by: `00000100` `01100110` (simplified)
        - The first byte `00000100` represents the count (4), the second byte `01100110` is the data that is repeated.
    - > [!NOTE] It's a little more complicated, as multiplier bytes are currently not distinguishable from the image data. There are many different methods to do so.

## Huffman coding
- used for lossless text compression
- sometimes used for sound files and vector graphics
- works by finding the most common values and assigns shorter codes to them, therefore sound with similar values for amplitude, and scalable vector graphics format (svg) which is text work great
- **Simplified:**
    1. look for the most used characters and assign them new codes (in the lookup table)
        - e.g. `e = 01` `t = 01`
        - > [!IMPORTANT] no code is the prefix of another code
    2. the codes are packed into a byte stream, where one byte contains multiple character codes and some 0s for padding

## Two lossy compression methods for audio:
- convert a file of amplitude values to a file of amplitude differences, then use a lower sampling rate to store those differences
- determine the frequency of rather consistent intervals and store one frequency and the timeframe rather than multiple amplitudes

---

# Extension Question 1.01:
| Format | Compression Type | Main algorithms |
|---|---|---|
| JPEG | Lossy | DCT, Quantization, Huffman/Arithmetic coding |
| GIF | Lossless | LZW Compression, Indexed Colors |
| PNG | Lossless | Deflate (LZ77 + Huffman coding) |
| TIFF | Lossless/Lossy | LZW, PackBits, Deflate, JPEG (optional) |
